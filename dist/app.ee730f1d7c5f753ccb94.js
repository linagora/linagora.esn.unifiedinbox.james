!function(e){var n={};function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=n,i.d=function(e,n,t){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)i.d(t,o,function(n){return e[n]}.bind(null,o));return t},i.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="",i(i.s=0)}({"+WKx":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlpQuarantineActions",{templateUrl:"/unifiedinbox.james/app/dlp/quarantine/actions/inbox-james-dlp-quarantine-actions.html",controller:"inboxJamesDlpQuarantineActionsController",bindings:{bulkAction:"<",email:"<",onClick:"&",repository:"<"}})}(angular)},0:function(e,n,i){i("9kT/"),i("VH2o"),i("0ykG"),i("knr9"),i("oqLS"),i("21b1"),i("CvDu"),i("iqKO"),i("zImL"),i("sb3V"),i("9QvG"),i("iTJP"),i("Ur8Z"),i("q51z"),i("Oneu"),i("1ohd"),i("53tb"),i("KxPK"),i("CsnO"),i("DO0J"),i("63B1"),i("XAek"),i("ChzF"),i("wKj1"),i("wm3o"),i("+WKx"),i("o4u0"),i("EEfC"),i("dX7s"),i("K+un"),i("Wugm"),i("BdXn"),i("xjqN"),i("IvKV"),i("1oGp"),i("sIh+"),i("t2wo"),i("Jz/3"),i("b4On"),i("iPln"),i("9iIs"),i("BFru"),i("0Dgd"),i("AfNK"),i("3QJM"),i("dlb4"),i("9fc+"),i("3/Sp"),i("tWuW"),i("6ozo"),i("T7wT"),i("Oo14"),i("ayFt"),i("YD5I"),i("xTcF"),i("HKj6"),e.exports=i("m3eD")},"0Dgd":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlpSettingsRuleForm",{templateUrl:"/unifiedinbox.james/app/dlp/settings/rule/inbox-james-dlp-settings-rule-form.html",controller:"InboxJamesDlpSettingsRuleFormController",bindings:{rule:"="}})}(angular)},"0ykG":function(e,n){!function(){"use strict";angular.module("linagora.esn.unifiedinbox.james").run(["inboxCustomRoleMailboxService","INBOX_RESTORED_MESSAGES_MAILBOX",function(e,n){e.add(n)}])}()},"1oGp":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlpRejected",{templateUrl:"/unifiedinbox.james/app/dlp/rejected/inbox-james-dlp-rejected.html",controller:"inboxJamesDlpRejectedController"})}(angular)},"1ohd":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").constant("INBOX_JAMES_DELETED_MESSAGES",{COMBINATOR:"and",CRITERIA:{DEFAULT_CRITERION:{fieldName:"subject",operator:"containsIgnoreCase"},FIELD_NAMES:[{value:"subject",label:"Subject"},{value:"hasAttachment",label:"Attachment"},{value:"recipients",label:"Recipients"},{value:"sender",label:"Sender"},{value:"deliveryDate",label:"Delivery date"},{value:"deletionDate",label:"Deletion date"}],SUBJECT:"subject",ATTACHMENT:"hasAttachment",RECIPIENTS:"recipients",SENDER:"sender",RECIPIENTS_OPERATOR:"contains",SENDER_OPERATOR:"equals",DELIVERY_DATE:"deliveryDate",DELETION_DATE:"deletionDate"}}).constant("INBOX_RESTORED_MESSAGES_MAILBOX",{role:"restored messages",icon:"mdi mdi-backup-restore"})}(angular)},"21b1":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDeletedMessagesCriteriaDateForm",{templateUrl:"/unifiedinbox.james/app/deleted-messages/criteria/date/inbox-james-deleted-messages-criteria-date-form.html",controller:"inboxJamesDeletedMessagesCriteriaDateFormController",bindings:{criterion:"<"}})}(angular)},"3/Sp":function(e,n){!function(e){"use strict";function n(e){return function(n){e.assign(this,e.pick(n,["name","sender","recipients","headers","lastUpdated","htmlBody","textBody","attributes","repository"])),this.to=this.recipients.map((function(e){return{email:e,name:e}})),this.date=this.lastUpdated,this.from=this.sender}}n.$inject=["_"],e.module("linagora.esn.unifiedinbox.james").factory("InboxJamesMailRepositoryEmail",n)}(angular)},"3QJM":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlpSettingsSubheader",{templateUrl:"/unifiedinbox.james/app/dlp/settings/subheader/inbox-james-dlp-settings-subheader.html",bindings:{onFormSubmit:"&",form:"<"}})}(angular)},"53tb":function(e,n){!function(e){"use strict";function n(e){return{submitRestoringRequest:function(n,i){return e.all("restoringDeletedMessagesRequest").customPOST({targetUser:n,content:i})}}}n.$inject=["inboxJamesRestangular"],e.module("linagora.esn.unifiedinbox.james").service("inboxJamesDeletedMessagesService",n)}(angular)},"63B1":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDeletedMessagesRestoreRequest",{templateUrl:"/unifiedinbox.james/app/deleted-messages/restore-request/inbox-james-deleted-messages-restore-request.html",controller:"InboxJamesDeletedMessagesRestoreRequestController"})}(angular)},"6ozo":function(e,n){!function(e){"use strict";function n(e,n,i,t){var o=this;function a(e){e?o.emails.forEach((function(e){i.toggleSelection(e,!0)})):i.unSelectAll()}o.$onInit=function(){e.$watch((function(){return o.emails.length===i.getSelected().length}),(function(e){!e&&o.selectedAllEmails&&o.repositorySelected&&(o.repositorySelected=!1),o.selectedAllEmails=!!e}))},o.getNumberOfSelectedEmails=function(){return i.getSelected().length},o.isSelecting=function(){return i.isSelecting()},o.onDeleteBtnClick=function(){var e={target:t.MULTIPLE,data:i.getSelected()};o.repositorySelected&&(e={target:t.ALL,data:o.repository});n.openMailsDeletingModal(e)},o.selectAllMails=function(e){o.repositorySelected=!1,e&&(o.selectedAllEmails=e);a(o.selectedAllEmails)},o.selectRepository=function(){o.repositorySelected=!0,o.bulkAction=!0,a(o.repositorySelected)}}n.$inject=["$scope","inboxJamesMailRepository","inboxJamesMailRepositoryEmailSelection","INBOX_JAMES_MAIL_REPOSITORY_MAIL_DELETION_TARGET"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesMailRepositoryHeaderController",n)}(angular)},"9QvG":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDeletedMessagesCriteriaItem",{templateUrl:"/unifiedinbox.james/app/deleted-messages/criteria/item/inbox-james-deleted-messages-criteria-item.html",controller:"InboxJamesDeletedMessagesCriteriaItemController",bindings:{criterion:"<",deleteCriterion:"&"}})}(angular)},"9fc+":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesMailRepositoryEmailDisplay",{templateUrl:"/unifiedinbox.james/app/mail-repository/email/inbox-james-mail-repository-email-display.html",bindings:{email:"<",download:"&",delete:"&"}})}(angular)},"9iIs":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlpSettings",{templateUrl:"/unifiedinbox.james/app/dlp/settings/inbox-james-dlp-settings.html",controller:"inboxJamesDlpSettingsController"})}(angular)},"9kT/":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james",["ui.router","op.dynamicDirective","restangular","uuid4","ngFileSaver","esn.session","esn.configuration","esn.async-action","esn.lodash-wrapper","esn.user","esn.session","esn.infinite-list","esn.i18n","esn.scroll","mgcrea.ngStrap.modal","linagora.esn.james","linagora.esn.unifiedinbox"])}(angular)},AfNK:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").controller("InboxJamesDlpSettingsRuleFormController",(function(){var e=this;e.onDeleteBtnClick=function(n){e.rule.deleted=!0,n.$setDirty()},e.onUndoBtnClick=function(){e.rule.deleted=!1}}))}(angular)},BFru:function(e,n){!function(e){"use strict";function n(e,n,i,t){var o=this,a={progressing:"Storing rules...",success:"Rules stored",failure:"Failed to store rules"},r=n.domain._id;o.$onInit=function(){o.status="loading",t.listDlpRules(r).then((function(e){o.rules=e,o.status="loaded"})).catch((function(){o.status="error"}))},o.addForm=function(){o.rules.unshift({id:e.generate()})},o.onFormSubmit=function(){return o.rules=function(e){return e.map((function(e){if(!e.deleted)return delete e.deleted,e})).filter(Boolean)}(o.rules),i(a,(function(){return t.storeDlpRules(r,o.rules)}))}}n.$inject=["uuid4","session","asyncAction","jamesApiClient"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesDlpSettingsController",n)}(angular)},BdXn:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlpRejectedActions",{templateUrl:"/unifiedinbox.james/app/dlp/rejected/actions/inbox-james-dlp-rejected-actions.html",controller:"inboxJamesDlpRejectedActionsController",bindings:{bulkAction:"<",email:"<",onClick:"&",repository:"<"}})}(angular)},ChzF:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlp",{templateUrl:"/unifiedinbox.james/app/dlp/inbox-james-dlp.html",bindings:{displayIn:"<"}})}(angular)},CsnO:function(e,n){!function(e){"use strict";function n(e,n){return e("linagora.esn.james.deletedMessages",{}).then((function(e){if(e.restore&&e.restore.isEnabled){var i=new n.DynamicDirective(!0,"inbox-james-deleted-messages-restore-button",{attributes:[{name:"ng-if",value:'ctrl.mailbox.role.value === "trash"'}]});n.addInjection("unifiedinbox-sidebar-folder-setting",i)}}))}n.$inject=["esnConfig","dynamicDirectiveService"],e.module("linagora.esn.unifiedinbox.james").run(n)}(angular)},CvDu:function(e,n){!function(e){"use strict";function n(e){var n=this;n.$onInit=function(){n.dateFormat=e.getDateFormat()}}n.$inject=["esnI18nDateFormatService"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesDeletedMessagesCriteriaDateFormController",n)}(angular)},DO0J:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDeletedMessagesRestoreRequestSubheader",{templateUrl:"/unifiedinbox.james/app/deleted-messages/restore-request/inbox-james-deleted-messages-restore-request-subheader.html",bindings:{onRequestSubmit:"&",form:"<",criteria:"<"}})}(angular)},EEfC:function(e,n){!function(e){"use strict";function n(e,n,i){e.ready.then((function(){var e=i.QUARANTINE,t=new n.DynamicDirective(!0,"inbox-james-dlp-quarantine-actions",{attributes:[{name:"ng-if",value:'$ctrl.repository==="'+e+'"'},{name:"ng-show",value:"$ctrl.getNumberOfSelectedEmails() || $ctrl.bulkAction"},{name:"repository",value:"$ctrl.repository"},{name:"bulk-action",value:"$ctrl.bulkAction"}]});n.addInjection("mail-repository-extra-actions",t);var o=new n.DynamicDirective(!0,"inbox-james-dlp-quarantine-actions",{attributes:[{name:"ng-if",value:'$ctrl.email.repository==="'+e+'"'},{name:"email",value:"$ctrl.email"},{name:"on-click",value:"$hide()"}]});n.addInjection("email-extra-actions",o)}))}n.$inject=["session","dynamicDirectiveService","INBOX_JAMES_DLP_MAIL_REPOSITORIES"],e.module("linagora.esn.unifiedinbox.james").run(n)}(angular)},HKj6:function(e,n){!function(e){"use strict";function n(e){var n=this;n.select=function(){e.toggleSelection(n.email)}}n.$inject=["inboxJamesMailRepositoryEmailSelection"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesMailRepositoryEmailSelectionController",n)}(angular)},IvKV:function(e,n){!function(e){"use strict";function n(e,n,i){e.ready.then((function(){var e=i.REJECTED,t=new n.DynamicDirective(!0,"inbox-james-dlp-rejected-actions",{attributes:[{name:"ng-if",value:'$ctrl.repository==="'+e+'"'},{name:"ng-show",value:"$ctrl.getNumberOfSelectedEmails() || $ctrl.bulkAction"},{name:"repository",value:"$ctrl.repository"},{name:"bulk-action",value:"$ctrl.bulkAction"}]});n.addInjection("mail-repository-extra-actions",t);var o=new n.DynamicDirective(!0,"inbox-james-dlp-rejected-actions",{attributes:[{name:"ng-if",value:'$ctrl.email.repository==="'+e+'"'},{name:"email",value:"$ctrl.email"},{name:"on-click",value:"$hide()"}]});n.addInjection("email-extra-actions",o)}))}n.$inject=["session","dynamicDirectiveService","INBOX_JAMES_DLP_MAIL_REPOSITORIES"],e.module("linagora.esn.unifiedinbox.james").run(n)}(angular)},"Jz/3":function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlpRuleDisplayer",{templateUrl:"/unifiedinbox.james/app/dlp/rule/inbox-james-dlp-rule-displayer.html",controller:"inboxJamesDlpRuleDisplayerController",bindings:{email:"<"}})}(angular)},"K+un":function(e,n){!function(e){"use strict";function n(e){var n=this;n.$onInit=function(){n.mailRepository=e.QUARANTINE}}n.$inject=["INBOX_JAMES_DLP_MAIL_REPOSITORIES"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesDlpQuarantineController",n)}(angular)},KxPK:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDeletedMessagesRestoreButton",{templateUrl:"/unifiedinbox.james/app/deleted-messages/restore-button/inbox-james-deleted-messages-restore-button.html"})}(angular)},Oneu:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDeletedMessagesCriteriaSubjectForm",{templateUrl:"/unifiedinbox.james/app/deleted-messages/criteria/subject/inbox-james-deleted-messages-criteria-subject-form.html",bindings:{criterion:"<"}})}(angular)},Oo14:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").constant("INBOX_JAMES_MAIL_REPOSITORY_EMAIL_FIELDS",["headers","textBody","htmlBody","attributes"]).constant("INBOX_JAMES_MAIL_REPOSITORY_EVENTS",{MAILS_REMOVED:"inbox-james:mail-repository:mails:removed",ALL_MAILS_REMOVED:"inbox-james:mail-repository:all-mails:removed"}).constant("INBOX_JAMES_MAIL_REPOSITORY_MAIL_DELETION_TARGET",{ALL:"all",SINGLE:"single",MULTIPLE:"multiple"}).constant("INBOX_JAMES_MAIL_REPOSITORY_PROCESSORS",{TRANSPORT:"transport",QUARANTINE:"dlpQuarantine",REJECT:"dlpReject"})}(angular)},T7wT:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesMailRepository",{templateUrl:"/unifiedinbox.james/app/mail-repository/inbox-james-mail-repository.html",controller:"inboxJamesMailRepositoryController",bindings:{repository:"<"}})}(angular)},Ur8Z:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDeletedMessagesCriteriaParticipantForm",{templateUrl:"/unifiedinbox.james/app/deleted-messages/criteria/participant/inbox-james-deleted-messages-criteria-participant-form.html",controller:"inboxJamesDeletedMessagesCriteriaParticipantFormController",bindings:{criterion:"<",participantType:"<"}})}(angular)},VH2o:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").config(["$stateProvider",function(e){e.state("admin.domain.dlp",{url:"/dlp",deepStateRedirect:{default:"admin.domain.dlp.quarantine",params:!0,fn:function(){return!0}}}).state("admin.domain.dlp.quarantine",{url:"/quarantine",views:{"root@admin":{template:"<inbox-james-dlp-quarantine />"}}}).state("admin.domain.dlp.rejected",{url:"/rejected",views:{"root@admin":{template:"<inbox-james-dlp-rejected />"}}}).state("admin.domain.dlp.settings",{url:"/settings",views:{"root@admin":{template:"<inbox-james-dlp-settings />"}}}).state("unifiedinbox.deleted-messages",{url:"/deleted-messages",views:{"main@unifiedinbox":{template:"<inbox-james-deleted-messages-restore-request />"}}})}])}(angular)},Wugm:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlpQuarantineSubheader",{templateUrl:"/unifiedinbox.james/app/dlp/quarantine/subheader/inbox-james-dlp-quarantine-subheader.html"})}(angular)},XAek:function(e,n){!function(e){"use strict";function n(e,n,i,t,o){var a=this,r={progressing:"Submitting request...",success:"Request is being processed",failure:"Failed to submit request"};a.onSendButtonClick=function(){return i(r,(function(){return t.submitRestoringRequest(n.user._id,{combinator:o.COMBINATOR,criteria:a.criteria}).then((function(){e.go("unifiedinbox")}))}))},a.criteria=[]}n.$inject=["$state","session","asyncAction","inboxJamesDeletedMessagesService","INBOX_JAMES_DELETED_MESSAGES"],e.module("linagora.esn.unifiedinbox.james").controller("InboxJamesDeletedMessagesRestoreRequestController",n)}(angular)},YD5I:function(e,n){!function(e){"use strict";function n(e,n,i,t,o,a,r,s,l,u,c){var m=r.domain._id;return{deleteAllMails:function(e){return a.removeAllMailsFromMailRepository(m,e).then((function(){t.$broadcast(c.ALL_MAILS_REMOVED)}))},deleteMails:function(e){return n.all(e.map((function(e){return a.removeMailFromMailRepository(m,e.repository,e.name)}))).then((function(){t.$broadcast(c.MAILS_REMOVED,{emails:e})}))},downloadEmlFile:function(e,n){a.downloadEmlFileFromMailRepository(m,e,n)},list:function(i,t){return a.listMailsFromMailRepository(m,i,t).then((function(t){var r=t.map((function(t){return function(i,t,r){return a.getMailFromMailRepository(i,t,r,{additionalFields:u.join(",")}).then((function(e){return e.repository=t,e})).then((function(i){if(!i.sender)return n.when(i);return s.getUsersByEmail(i.sender).then((function(n){var t=n.data&&n.data[0]||{};return i.sender=e.assign({},t,{email:i.sender,name:l.displayNameOf(t)||i.sender}),i})).catch((function(){return i}))})).then((function(e){return new o(e)}))}(m,i,t)}));return n.all(r)}))},openMailsDeletingModal:function(e){i({templateUrl:"/unifiedinbox.james/app/mail-repository/email/delete/inbox-james-mail-repository-email-delete-dialog.html",backdrop:"static",placement:"center",controller:"inboxJamesMailRepositoryEmailDeleteDialogController",controllerAs:"$ctrl",locals:{context:e}})}}}n.$inject=["_","$q","$modal","$rootScope","InboxJamesMailRepositoryEmail","jamesApiClient","session","userAPI","userUtils","INBOX_JAMES_MAIL_REPOSITORY_EMAIL_FIELDS","INBOX_JAMES_MAIL_REPOSITORY_EVENTS"],e.module("linagora.esn.unifiedinbox.james").factory("inboxJamesMailRepository",n)}(angular)},ayFt:function(e,n){!function(e){"use strict";function n(e,n,i,t,o,a,r,s){var l=this,u=a||20,c={offset:0,limit:u};function m(e,n){n.emails&&(n.emails.forEach((function(e){l.elements=l.elements.filter((function(n){return n.name!==e.name}))})),o.unSelectAll())}function d(){l.elements.length=0,o.unSelectAll()}function f(){return c.offset=l.elements.length,t.list(l.repository,c)}l.$onInit=function(){l.loadMoreElements=i(l,f,null,u),e.$on(r.MAILS_REMOVED,m),e.$on(r.ALL_MAILS_REMOVED,d)},l.$onDestroy=function(){o.unSelectAll()},l.downloadMail=function(e){t.downloadEmlFile(l.repository,e.name)},l.deleteMail=function(e){t.openMailsDeletingModal({target:s.SINGLE,data:e})}}n.$inject=["$scope","_","infiniteScrollHelper","inboxJamesMailRepository","inboxJamesMailRepositoryEmailSelection","ELEMENTS_PER_REQUEST","INBOX_JAMES_MAIL_REPOSITORY_EVENTS","INBOX_JAMES_MAIL_REPOSITORY_MAIL_DELETION_TARGET"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesMailRepositoryController",n)}(angular)},b4On:function(e,n){!function(e){"use strict";function n(e,n,i,t){var o=this;o.$onInit=function(){var a=[t.QUARANTINE,t.REJECTED];o.shouldDisplay=o.email.attributes&&!!o.email.attributes.DlpMatchedRule&&-1!==a.indexOf(o.email.repository),o.shouldDisplay&&i.getDlpRule(e.domain._id,o.email.attributes.DlpMatchedRule).then((function(e){o.rule=function(e){var i=[];return e.targetsContent&&i.push(n.translate("message content").toString()),e.targetsSender&&i.push(n.translate("sender").toString()),e.targetsRecipients&&i.push(n.translate("recipients").toString()),e.source=i.join(", "),e}(e)})).catch((function(){o.ruleNotFound=!0}))}}n.$inject=["session","esnI18nService","jamesApiClient","INBOX_JAMES_DLP_MAIL_REPOSITORIES"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesDlpRuleDisplayerController",n)}(angular)},dX7s:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlpQuarantine",{templateUrl:"/unifiedinbox.james/app/dlp/quarantine/inbox-james-dlp-quarantine.html",controller:"inboxJamesDlpQuarantineController"})}(angular)},dlb4:function(e,n){!function(e){"use strict";function n(e,n,i,t,o,a,r){var s=this;function l(){return i.target===r.ALL?a.deleteAllMails(i.data):i.target===r.MULTIPLE?a.deleteMails(i.data):i.target===r.SINGLE?a.deleteMails([i.data]):void 0}s.$onInit=function(){s.target=1===i.data.length?r.SINGLE:i.target,s.onDeleteBtnClick=function(){return t(function(){if(s.target===r.ALL)return{progressing:"Deleting all mails...",success:"All mails deleted",failure:"Failed to delete mails"};if(s.target===r.SINGLE)return{progressing:"Deleting mail...",success:"Mail deleted",failure:"Failed to delete mail"};if(s.target===r.MULTIPLE)return{progressing:o.translate("Deleting %s mails...",i.data.length),success:o.translate("%s mails deleted",i.data.length),failure:"Failed to delete mails"}}(),l)}}}n.$inject=["$q","_","context","asyncAction","esnI18nService","inboxJamesMailRepository","INBOX_JAMES_MAIL_REPOSITORY_MAIL_DELETION_TARGET"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesMailRepositoryEmailDeleteDialogController",n)}(angular)},iPln:function(e,n){!function(e){"use strict";function n(e){var n=new e.DynamicDirective(!0,"inbox-james-dlp-rule-displayer",{attributes:[{name:"email",value:"::$ctrl.email"}]});e.addInjection("mail-repository-mail-extra-info",n)}n.$inject=["dynamicDirectiveService"],e.module("linagora.esn.unifiedinbox.james").run(n)}(angular)},iTJP:function(e,n){!function(e){"use strict";function n(e,n){var i=this;i.types=n.CRITERIA.FIELD_NAMES,i.getCriterionSummary=function(){return e.getCriterionSummary(i.criterion)},i.resetCriterion=function(){i.criterion.value="",i.criterion.operator=""}}n.$inject=["inboxJamesDeletedMessageCriteriaService","INBOX_JAMES_DELETED_MESSAGES"],e.module("linagora.esn.unifiedinbox.james").controller("InboxJamesDeletedMessagesCriteriaItemController",n)}(angular)},iqKO:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDeletedMessagesCriteriaForm",{templateUrl:"/unifiedinbox.james/app/deleted-messages/criteria/form/inbox-james-deleted-messages-criteria-form.html",controller:"InboxJamesDeletedMessagesCriteriaFormController",bindings:{criteria:"="}})}(angular)},knr9:function(e,n){!function(){"use strict";e.$inject=["Restangular"];function e(e){return e.withConfig((function(e){e.setBaseUrl("/unifiedinbox.james/api"),e.setFullResponse(!0)}))}angular.module("linagora.esn.unifiedinbox.james").factory("inboxJamesRestangular",e)}()},m3eD:function(e,n){!function(e){"use strict";function n(n){var i,t=[];return{isSelecting:function(){return i},getSelected:function(){return n.clone(t)},toggleSelection:function(o,a){if(a=e.isDefined(a)?a:!o.selected,o.selected===a)return;o.selected=a,o.selected?t.push(o):n.pull(t,o);i=t.length>0},unSelectAll:function(){t.forEach((function(e){e.selected=!1})),t.length=0,i=!1}}}n.$inject=["_"],e.module("linagora.esn.unifiedinbox.james").factory("inboxJamesMailRepositoryEmailSelection",n)}(angular)},o4u0:function(e,n){!function(e){"use strict";function n(e,n,i,t,o,a,r,s){var l=this,u=a.domain._id,c={progressing:"Moving mails...",success:"Emails moved to rejected repository",failure:"Failed to move mails"},m={progressing:"Scheduling mails delivery...",success:"Delivery of mails scheduled",failure:"Failed to schedule delivery"};function d(i){if(l.onClick&&l.onClick(),l.bulkAction)return t.reprocessAllMailsFromMailRepository(u,l.repository,{processor:i}).then((function(){n.$broadcast(s.ALL_MAILS_REMOVED)}));var a=l.email?[l.email]:o.getSelected();return e.all(a.map((function(e){return t.reprocessMailFromMailRepository(u,e.repository,e.name,{processor:i})}))).then((function(){n.$broadcast(s.MAILS_REMOVED,{emails:a})}))}l.onDenyBtnClick=function(){return i(c,(function(){return d(r.REJECT)}))},l.onAllowBtnClick=function(){return i(m,(function(){return d(r.TRANSPORT)}))}}n.$inject=["$q","$rootScope","asyncAction","jamesApiClient","inboxJamesMailRepositoryEmailSelection","session","INBOX_JAMES_MAIL_REPOSITORY_PROCESSORS","INBOX_JAMES_MAIL_REPOSITORY_EVENTS"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesDlpQuarantineActionsController",n)}(angular)},oqLS:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDeletedMessagesCriteriaAttachmentForm",{templateUrl:"/unifiedinbox.james/app/deleted-messages/criteria/attachment/inbox-james-deleted-messages-criteria-attachment-form.html",bindings:{criterion:"<"}})}(angular)},q51z:function(e,n){!function(e){"use strict";function n(e){var n=this;n.$onInit=function(){n.participantType===e.CRITERIA.RECIPIENTS&&(n.criterion.operator=e.CRITERIA.RECIPIENTS_OPERATOR);n.participantType===e.CRITERIA.SENDER&&(n.criterion.operator=e.CRITERIA.SENDER_OPERATOR);n.paritipants=n.criterion.value?[{email:n.criterion.value}]:[]},n.onTagAdded=function(e){n.criterion.value=e.email},n.onTagRemoved=function(){n.criterion.value=""}}n.$inject=["INBOX_JAMES_DELETED_MESSAGES"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesDeletedMessagesCriteriaParticipantFormController",n)}(angular)},"sIh+":function(e,n){!function(e){"use strict";function n(e){var n=this;n.$onInit=function(){n.mailRepository=e.REJECTED}}n.$inject=["INBOX_JAMES_DLP_MAIL_REPOSITORIES"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesDlpRejectedController",n)}(angular)},sb3V:function(e,n){!function(e){"use strict";function n(e,n,i){return{getCriterionSummary:function(n){switch(n.fieldName){case i.CRITERIA.SUBJECT:return function(n){var i;switch(n.operator){case"contains":i="Messages whose subjects contain exactly <b>%s</b>";break;case"containsIgnoreCase":i="Messages whose subjects contain <b>%s</b>";break;case"equals":i="Messages whose subjects match exactly <b>%s</b>";break;case"equalsIgnoreCase":i="Messages whose subjects match <b>%s</b>";break;default:i=""}return e.translate(i,n.value||"").toString()}(n);case i.CRITERIA.ATTACHMENT:return function(n){var i="Messages have attachment";n.value||(i="Messages do not have attachment");return e.translate(i).toString()}(n);case i.CRITERIA.RECIPIENTS:return function(n){return e.translate("Messages whose recipients contain <b>%s</b>",n.value||"").toString()}(n);case i.CRITERIA.SENDER:return function(n){return e.translate("Messages whose sender is <b>%s</b>",n.value||"").toString()}(n);case i.CRITERIA.DELIVERY_DATE:case i.CRITERIA.DELETION_DATE:return t(n);default:return""}}};function t(i){var t={beforeOrEquals:" before or on <b>%s</b>",afterOrEquals:" after or on <b>%s</b>"},o=t[i.operator]?{deliveryDate:"Messages whose delivery date is",deletionDate:"Messages whose deletion date is"}[i.fieldName]+t[i.operator]:"";return e.translate(o,n.formatShortDate(i.value)).toString()}}n.$inject=["esnI18nService","esnDatetimeService","INBOX_JAMES_DELETED_MESSAGES"],e.module("linagora.esn.unifiedinbox.james").factory("inboxJamesDeletedMessageCriteriaService",n)}(angular)},t2wo:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesDlpRejectedSubheader",{templateUrl:"/unifiedinbox.james/app/dlp/rejected/subheader/inbox-james-dlp-rejected-subheader.html"})}(angular)},tWuW:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesMailRepositoryHeader",{templateUrl:"/unifiedinbox.james/app/mail-repository/header/inbox-james-mail-repository-header.html",controller:"inboxJamesMailRepositoryHeaderController",bindings:{emails:"<",repository:"@"}})}(angular)},wKj1:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").constant("INBOX_JAMES_DLP_MAIL_REPOSITORIES",{QUARANTINE:"dlpQuarantine",REJECTED:"dlpRejected"})}(angular)},wm3o:function(e,n){!function(e){"use strict";function n(e){var n=new e.DynamicDirective(!0,"inbox-james-dlp",{attributes:[{name:"display-in",value:"$ctrl.displayIn"}]});e.addInjection("admin-sidebar",n)}n.$inject=["dynamicDirectiveService"],e.module("linagora.esn.unifiedinbox.james").run(n)}(angular)},xTcF:function(e,n){!function(e){"use strict";e.module("linagora.esn.unifiedinbox.james").component("inboxJamesMailRepositoryEmailSelection",{templateUrl:"/unifiedinbox.james/app/mail-repository/selection/inbox-james-mail-repository-email-selection.html",controller:"inboxJamesMailRepositoryEmailSelectionController",bindings:{email:"<"}})}(angular)},xjqN:function(e,n){!function(e){"use strict";function n(e,n,i,t,o,a,r,s){var l=this,u=a.domain._id,c={progressing:"Moving mails...",success:"Emails moved to quarantined repository",failure:"Failed to move mails"};l.onQuarantineBtnClick=function(){return i(c,(function(){return function(){var i=r.QUARANTINE;if(l.bulkAction)return t.reprocessAllMailsFromMailRepository(u,l.repository,{processor:i}).then((function(){n.$broadcast(s.ALL_MAILS_REMOVED)}));if(l.email)return l.onClick(),t.reprocessMailFromMailRepository(u,l.email.repository,l.email.name,{processor:i}).then((function(){n.$broadcast(s.MAILS_REMOVED,{emails:[l.email]})}));var a=o.getSelected();return e.all(a.map((function(e){return t.reprocessMailFromMailRepository(u,e.repository,e.name,{processor:i})}))).then((function(){n.$broadcast(s.MAILS_REMOVED,{emails:a})}))}()}))}}n.$inject=["$q","$rootScope","asyncAction","jamesApiClient","inboxJamesMailRepositoryEmailSelection","session","INBOX_JAMES_MAIL_REPOSITORY_PROCESSORS","INBOX_JAMES_MAIL_REPOSITORY_EVENTS"],e.module("linagora.esn.unifiedinbox.james").controller("inboxJamesDlpRejectedActionsController",n)}(angular)},zImL:function(e,n){!function(e){"use strict";function n(e,n,i,t,o){var a=this;a.$onInit=function(){a.criteria=a.criteria||[]},a.addCriterion=function(){a.criteria.push(e.clone(o.CRITERIA.DEFAULT_CRITERION)),n((function(){t.scrollDownToElement($(e.last(i.find("inbox-james-deleted-messages-criteria-item"))))}),0)},a.deleteCriterion=function(e){a.criteria.splice(e,1)}}n.$inject=["_","$timeout","$element","elementScrollService","INBOX_JAMES_DELETED_MESSAGES"],e.module("linagora.esn.unifiedinbox.james").controller("InboxJamesDeletedMessagesCriteriaFormController",n)}(angular)}});